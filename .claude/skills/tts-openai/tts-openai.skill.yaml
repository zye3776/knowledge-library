skill:
  metadata:
    id: _bmad/custom/skills/tts-openai/tts-openai.skill.md
    name: "OpenAI TTS"
    description: "High-quality text-to-speech using OpenAI TTS API. Supports chunked paragraph-by-paragraph playback with pause/resume. Requires OPENAI_API_KEY."
    icon: "ðŸ”Š"

  install_config:
    description: "Configure your OpenAI TTS settings"
    questions:
      - var: default_voice
        type: choice
        prompt: "Default voice for speech synthesis"
        default: nova
        options:
          - { label: "Nova - Friendly, natural (recommended)", value: "nova" }
          - { label: "Alloy - Neutral, balanced", value: "alloy" }
          - { label: "Echo - Warm, conversational", value: "echo" }
          - { label: "Fable - Expressive, British accent", value: "fable" }
          - { label: "Onyx - Deep, authoritative", value: "onyx" }
          - { label: "Shimmer - Soft, gentle", value: "shimmer" }

      - var: default_model
        type: choice
        prompt: "Default TTS model"
        default: tts-1
        options:
          - { label: "tts-1 - Good quality, faster ($15/1M chars)", value: "tts-1" }
          - { label: "tts-1-hd - Premium quality ($30/1M chars)", value: "tts-1-hd" }

  setup: |
    ## Requirements

    1. **OpenAI API Key** - Set as environment variable:
       ```bash
       export OPENAI_API_KEY="your-key-here"
       ```

    2. **Build the executable** (one-time setup):
       ```bash
       cd .claude/skills/tts-openai
       bun install
       bun run build
       ```
       This creates `scripts/speak` - a standalone executable with no runtime dependencies.

  usage: |
    ## Single File Mode (Basic)

    ```bash
    # Speak text directly
    ./scripts/speak "Hello world"

    # Read from file
    ./scripts/speak -f /tmp/digest.txt

    # Choose voice
    ./scripts/speak -v {{default_voice}} -f /tmp/digest.txt

    # Save to file instead of playing
    ./scripts/speak -o output.mp3 -f /tmp/digest.txt
    ```

    ## Chunked Paragraph Mode (For Long Documents)

    Splits text into paragraphs, generates audio for each, and plays sequentially.
    Supports pause/resume - perfect for long documents.

    ```bash
    # Generate and play paragraph by paragraph
    ./scripts/speak --chunked -f document.txt -d /path/to/output

    # Generate only (don't play)
    ./scripts/speak --chunked --generate-only -f doc.txt -d /path/to/output

    # Resume from last position
    ./scripts/speak --resume -d /path/to/output

    # Stop playback (saves position)
    ./scripts/speak --stop

    # Check playback status
    ./scripts/speak --status -d /path/to/output
    ```

    ## Playback Controls

    Progress bar displays as:
    ```
    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 3/14 | 2:35 remaining
    ```

    - **Terminate anytime** - position auto-saves after each paragraph
    - **Resume**: Use `--resume -d /path` to continue from last paragraph
    - **Status**: Use `--status -d /path` to see progress
    - **Stop**: Use `--stop` to immediately stop (optional - just terminating works too)

  sections:
    Chunked Output Structure: |
      When using `--chunked`, the output directory contains:

      ```
      /path/to/output/
      â”œâ”€â”€ paragraphs.json    # Paragraph text and metadata
      â”œâ”€â”€ playback.json      # Playback state (position, status)
      â””â”€â”€ paragraphs/        # Audio files
          â”œâ”€â”€ 001.mp3
          â”œâ”€â”€ 002.mp3
          â””â”€â”€ ...
      ```

      **Note:** `playback.json` tracks playback position and should not be
      committed to source control (add to .gitignore).

    Voices: |
      | Voice | Description |
      |-------|-------------|
      | alloy | Neutral, balanced |
      | echo | Warm, conversational |
      | fable | Expressive, British accent |
      | nova | Friendly, natural (default) |
      | onyx | Deep, authoritative |
      | shimmer | Soft, gentle |

    Models: |
      | Model | Quality | Cost |
      |-------|---------|------|
      | tts-1 | Good (default) | $15 / 1M chars |
      | tts-1-hd | Premium | $30 / 1M chars |

      Use `--model tts-1-hd` for higher quality when needed.

    Cost Estimate: |
      - ~300 words â‰ˆ 1,500 characters
      - 1 hour/day usage â‰ˆ $0.70/month (tts-1)
