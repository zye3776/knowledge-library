#!/bin/sh

# Load API key from .env.local if it exists (not committed to git)
[ -f .env.local ] && export $(grep -v '^#' .env.local | xargs)

# Get staged markdown files (excluding CLAUDE.md)
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR | grep '\.md$' | grep -v 'CLAUDE\.md$' || true)

if [ -z "$STAGED_FILES" ]; then
  exit 0
fi

# Pass staged files to the pre-commit index script
# shellcheck disable=SC2086
bun scripts/pre-commit-index.ts $STAGED_FILES
